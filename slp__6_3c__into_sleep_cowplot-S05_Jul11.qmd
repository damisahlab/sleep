---
title: "Cowplot Transition into Sleep"
format: html
editor: visual
jupyter: python3
---

## Configuration

```{r, setup, include = FALSE}
knitr::opts_knit$set(root.dir = 'Z:/Layton/Sleep_083023')
```

```{r}
library(tidyverse)
library(cowplot)
```

## Parameters

```{r}
spectro <- readRDS('Cache/Subject05/Jul11/S05_spectro_t11700.RDS')
zspike <- readRDS('Cache/Subject05/Jul11/S05_zspike_t11700.RDS')
swa_1 <- readRDS('Cache/Subject05/Jul11/S05_swa_t11700_part1.RDS')
spike_1 <- readRDS('Cache/Subject05/Jul11/S05_spike_raster_t11700_part1.RDS')
swa_2 <- readRDS('Cache/Subject05/Jul11/S05_swa_t11700_part2.RDS')
spike_2 <- readRDS('Cache/Subject05/Jul11/S05_spike_raster_t11700_part2.RDS')
```

```{r}
output_path_top <- 'Results/S05_Jul11_transition_t11700_top.svg'
output_path_top_px <- 'Results/S0_Jul115_transition_t11700_top.png'
output_path_bot <- 'Results/S05_Jul11_transition_t11700_bottom.svg'
output_path_bot_px <- 'Results/S05_Jul11_transition_t11700_bottom.png'
```

## Plotting

```{r}
spectro <- spectro + theme(legend.position = 'none', 
                           plot.margin = unit(c(1, 0, 0, 0), 'cm'))
zspike <- zspike + theme(legend.position = 'none', 
                         plot.margin = unit(c(0, 0, 1, 0), 'cm'))
swa_1 <- swa_1 + theme(legend.position = 'none', 
                       plot.margin = unit(c(1, 0, 0, 0), 'cm'))
spike_1 <- spike_1 + theme(legend.position = 'none', 
                           plot.margin = unit(c(0, 0, 1, 0), 'cm'))
swa_2 <- swa_2 + theme(legend.position = 'none', 
                       plot.margin = unit(c(1, 0, 0, 0), 'cm'))
spike_2 <- spike_2 + theme(legend.position = 'none', 
                           plot.margin = unit(c(0, 0, 1, 0), 'cm'))
```

```{r}
# Top Plot
plot_grid(spectro, zspike, 
          ncol = 1, align = 'v', axis = 'lr',
          rel_heights = c(1, 1))

ggsave(file = output_path_top, width = 10, height = 3.3, 
       dpi = 300, limitsize = FALSE)

ggsave(file = output_path_top_px, 
       width = 2600, height = 780, 
       units = 'px', limitsize = FALSE)
```

```{r}
# Bottom Plot
plot_grid(swa_1, spike_1, swa_2, spike_2, 
          ncol = 1, align = 'v',  axis = 'lr',
          rel_heights = c(1, 1, 1, 1))

ggsave(file = output_path_bot, width = 5, height = 5, 
       dpi = 300, limitsize = FALSE)

ggsave(file = output_path_bot_px, 
       width = 1300, height = 2000, 
       units = 'px', limitsize = FALSE)
```
